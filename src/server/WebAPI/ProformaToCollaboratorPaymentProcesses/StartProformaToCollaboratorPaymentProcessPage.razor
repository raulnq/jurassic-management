@using WebAPI.Infrastructure.SqlKata;
@using WebAPI.Infrastructure.Ui;
@using WebAPI.Proformas

<Heading Text="Collaborator Payments" />
<Breadcrumbs Links=@(new Breadcrumbs.Link[]{ new("List collaborator payments",WebAPI.CollaboratorPayments.Endpoints.List.AddListParameters()), new("Register collaborator payment") })
             Target=@(Infrastructure.Ui.Targets.Workspace) />
<Section>
    <Content>
        <Form HtmxProps=@(new HtmxProps(Endpoints.Register, Infrastructure.Ui.Targets.Workspace))>
            <Content>
                <FormRow>
                    <Content>
                        <div class="col-6">
                            <SelectInput Property=@nameof(StartProformaToCollaboratorPaymentProcess.Command.CollaboratorId)
                                         Label="Collaborator"
                                         HtmxProps=@(new HtmxProps(@WebAPI.Proformas.Endpoints.SearchNotAddedToCollaboratorPayment, $"#{nameof(StartProformaToCollaboratorPaymentProcess.Command.ProformaId)}"){Include=$"#{nameof(StartProformaToCollaboratorPaymentProcess.Command.Currency)}"})
                                         Source=@Collaborators.ToDictionary(c=>c.CollaboratorId, c=>c.Name)
                                         Required=true>
                            </SelectInput>
                        </div>
                        <div class="col-6">
                            <SelectInput Property=@nameof(StartProformaToCollaboratorPaymentProcess.Command.Currency)
                                         Label="Currency"
                                         Source=@(Enum.GetValues<Currency>().ToDictionary(i=>i.ToString(), i=>i.ToString()))
                                         HtmxProps=@(new HtmxProps(@WebAPI.Proformas.Endpoints.SearchNotAddedToCollaboratorPayment, $"#{nameof(StartProformaToCollaboratorPaymentProcess.Command.ProformaId)}"){Include=$"#{nameof(StartProformaToCollaboratorPaymentProcess.Command.CollaboratorId)}"})
                                         Required=true>
                            </SelectInput>
                        </div>
                    </Content>
                </FormRow>
                <FormRow>
                    <Content>
                        <div class="col">
                            <SelectInput Property=@(nameof(StartProformaToCollaboratorPaymentProcess.Command.ProformaId))
                                         Label="Proformas"
                                         Required=true
                                         Multiple=true
                                         TKey=Guid>
                            </SelectInput>
                        </div>
                    </Content>
                </FormRow>
            </Content>
        </Form>
    </Content>
</Section>

@code {
    [Parameter, EditorRequired]
    public List<WebAPI.Collaborators.SearchCollaborators.Result> Collaborators { get; set; } = default!;
}
